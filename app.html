<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>AI Diet Planner</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin:0; 
      font-family:system-ui; 
      background:#0b0c10; 
      color:#e6e7eb; 
      display:flex; 
      flex-direction:column; 
      align-items:center;
    }
    header {text-align:center; margin:20px;}
    .container {
      max-width:1400px; width:100%; display:flex; gap:20px; margin:20px; justify-content:center;
    }
    .side-img {flex:0 0 250px; display:flex; flex-direction:column; gap:20px;}
    .side-img img {width:100%; border-radius:14px; border:1px solid rgba(255,255,255,.1);}
    .app {flex:1; display:flex; gap:20px; flex-wrap:wrap;}
    .card {
      background:#111319; border-radius:18px; padding:20px;
      box-shadow:0 6px 18px rgba(0,0,0,.35); flex:1 1 300px;
    }
    .btn {
      display:inline-block; padding:12px 18px; border-radius:12px;
      background:linear-gradient(135deg,#6ee7b7,#60a5fa); color:#0b1220;
      font-weight:700; cursor:pointer; border:none; margin-top:10px; text-decoration:none; text-align:center;
    }
    .btn:hover {opacity:0.9; transform:scale(1.05); transition:0.2s;}
    input[type=file]{display:none}
    .preview img {max-width:100%; border-radius:14px; border:1px solid rgba(255,255,255,.1);}
    .diet {margin-top:12px; line-height:1.5;}
    h2 {margin-top:0;}
    #lang-switcher {display:flex; justify-content:center; gap:10px; margin-top:10px;}
    .flag {cursor: pointer; width: 40px; height: 28px; border-radius:6px; border:2px solid transparent; transition: all 0.3s ease;}
    .flag:hover {transform: scale(1.2);}
    .flag.active {border-color:#60a5fa; background: rgba(96,165,250,0.2);}
    .inputs {margin-top:15px; display:flex; gap:10px; flex-wrap:wrap;}
    .inputs input {flex:1 1 120px; padding:10px; border-radius:10px; border:1px solid #333; background:#1a1c22; color:#e6e7eb;}
    #week {margin-top:20px; padding-top:15px; border-top:1px solid #333;}
    #week h3 {margin-top:0;}
    @media (max-width:1200px){
      .container {flex-direction:column; align-items:center;}
      .side-img {flex-direction:row; width:100%; justify-content:space-between;}
      .side-img img {width:48%;}
      .app {width:100%;}
    }
    :root {--gold: #FFD700; --gold-1: #c78f00; --gold-2: #9a6900; --gold-3: #6a4500;}
    * {color: var(--gold) !important; text-shadow:1px 1px 0 var(--gold-1),2px 2px 0 var(--gold-2),3px 3px 0 var(--gold-3),0 6px 18px rgba(0,0,0,0.6);}
    .btn, a, button, input, textarea, select, label {color: var(--gold) !important; text-shadow:1px 1px 0 var(--gold-1),2px 2px 0 var(--gold-2),3px 3px 0 var(--gold-3),0 6px 18px rgba(0,0,0,0.6) !important;}
    input::placeholder, textarea::placeholder {color: var(--gold) !important; opacity:1;}
    #animated-counter span {background:none !important; -webkit-background-clip: unset !important; background-clip: unset !important; -webkit-text-fill-color: var(--gold) !important; color: var(--gold) !important; text-shadow: 1px 1px 0 var(--gold-1),2px 2px 0 var(--gold-2),3px 3px 0 var(--gold-3),0 6px 18px rgba(0,0,0,0.6) !important;}
  </style>
</head>
<body>
  <header>
    <h1 id="title">AI Diet Planner (online)</h1>
    <p id="subtitle">Загрузи фото — получи готовую диету</p>
    <div id="lang-switcher">
      <img class="flag active" data-lang="ru" src="https://flagcdn.com/w40/ru.png" alt="RU">
      <img class="flag" data-lang="en" src="https://flagcdn.com/w40/gb.png" alt="EN">
      <img class="flag" data-lang="ka" src="https://flagcdn.com/w40/ge.png" alt="GE">
    </div>
    <a href="diets.html" class="btn">Перейти к диетам</a>
  </header>

  <div class="container">
    <div class="side-img"><img src="11.png" alt="11"></div>
    <main class="app">
      <section class="card">
        <h2 id="uploadTitle">Загрузка фото</h2>
        <label class="btn" for="file" id="uploadBtn">Выбрать фото</label>
        <input type="file" id="file" accept="image/*">
        <div class="preview" style="margin-top:16px"><img id="img" hidden></div>
        <div class="inputs">
          <input type="number" id="height" placeholder="Рост (см)">
          <input type="number" id="weight" placeholder="Вес (кг)">
        </div>
        <button class="btn" id="analyze">Назначить диету</button>
      </section>
      <section class="card">
        <h2 id="resultTitle">Твоя диета</h2>
        <div id="result" class="diet">Здесь появится план питания</div>
        <div id="week"></div>
      </section>
    </main>
    <div class="side-img"><img src="10.png" alt="10"></div>
  </div>

  <!-- График прогресса -->
  <h3 style="text-align:center; margin-top:20px;">График калорий и веса</h3>
  <canvas id="chart" width="400" height="200" style="max-width:600px; margin:0 auto; display:block;"></canvas>

  <!-- Счётчик -->
  <div style="max-width:300px; margin:30px auto; padding:15px; background:#111319; border-radius:18px; box-shadow:0 6px 18px rgba(0,0,0,.35); text-align:center; font-family:system-ui;">
    <div style="color:#60a5fa; font-weight:bold; margin-bottom:10px;">Free Visitors</div>
    <div id="animated-counter" style="display:flex; justify-content:center; gap:2px; font-size:28px; font-weight:700;"></div>
    <a href='http://www.freevisitorcounters.com' target="_blank" style="display:block; margin-top:10px; color:#60a5fa; text-decoration:none; font-size:12px;">Powered by FreeVisitorCounters</a>
  </div>

  <script type='text/javascript' src='https://www.freevisitorcounters.com/auth.php?id=9b7eba1f58bc50b78c2890451ccdcd526dab15be'></script>
  <script type="text/javascript" src="https://www.freevisitorcounters.com/en/home/counter/1387540/t/6"></script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script>
    const counterContainer = document.getElementById('animated-counter');
    function animateDigits(newNumber) {
      counterContainer.innerHTML = '';
      newNumber.toString().split('').forEach(digit=>{
        const span = document.createElement('span');
        span.innerText = digit;
        span.style.display = 'inline-block';
        span.style.background = 'linear-gradient(135deg,#6ee7b7,#60a5fa)';
        span.style.webkitBackgroundClip = 'text';
        span.style.color = 'transparent';
        span.style.transition = 'transform 0.3s ease';
        counterContainer.appendChild(span);
        setTimeout(()=>{ span.style.transform = 'translateY(-10px)'; }, 50);
        setTimeout(()=>{ span.style.transform = 'translateY(0)'; }, 300);
      });
    }
    function updateAnimatedCounter() {
      const fvcEl = document.querySelector('div[id^="fvc_counter"]');
      if(fvcEl){
        const count = parseInt(fvcEl.innerText.replace(/\D/g,'')) || 0;
        animateDigits(count);
      }
    }
    setInterval(updateAnimatedCounter, 1000);
    window.addEventListener('load', updateAnimatedCounter);

    const fileInput = document.getElementById('file');
    const img = document.getElementById('img');
    const analyzeBtn = document.getElementById('analyze');
    const resultEl = document.getElementById('result');
    const weekEl = document.getElementById('week');
    const flags = document.querySelectorAll('.flag');
    let currentLang = "ru";

    const diets = {
      ru: {
        loss: {title:"Похудение", text:"08:00 – Завтрак: овсянка с ягодами (300 ккал)\n13:00 – Обед: куриная грудка + салат (450 ккал)\n19:00 – Ужин: салат с тунцом (350 ккал)",
          week:["Понедельник: овощной суп, салат","Вторник: рыба на пару, гречка","Среда: куриная грудка, овощи","Четверг: омлет, салат","Пятница: творог, фрукты","Суббота: индейка, овощи","Воскресенье: лёгкий суп, овощи"]},
        gain: {title:"Набор массы", text:"08:00 – Омлет из 4 яиц, хлеб (500 ккал)\n13:30 – Обед: рис, говядина, овощи (700 ккал)\n20:00 – Ужин: паста с курицей (600 ккал)",
          week:["Понедельник: курица, рис","Вторник: говядина, картофель","Среда: омлет, тосты","Четверг: паста, курица","Пятница: рыба, рис","Суббота: индейка, макароны","Воскресенье: пицца домашняя"]},
        keep: {title:"Поддержание веса", text:"07:30 – Йогурт с мюсли (350 ккал)\n13:00 – Обед: курица, гречка, овощи (550 ккал)\n19:30 – Ужин: рыба + салат (450 ккал)",
          week:["Понедельник: каша, фрукты","Вторник: рыба, овощи","Среда: курица, салат","Четверг: омлет, овощи","Пятница: йогурт, орехи","Суббота: индейка, овощи","Воскресенье: овощной суп"]}
      },
      en: {
        loss: {title:"Weight Loss", text:"08:00 – Breakfast: oatmeal with berries (300 kcal)\n13:00 – Lunch: grilled chicken + salad (450 kcal)\n19:00 – Dinner: tuna salad (350 kcal)",
          week:["Mon: vegetable soup, salad","Tue: steamed fish, buckwheat","Wed: chicken breast, veggies","Thu: omelet, salad","Fri: cottage cheese, fruits","Sat: turkey, veggies","Sun: light soup, salad"]},
        gain: {title:"Muscle Gain", text:"08:00 – Breakfast: 4-egg omelet, bread (500 kcal)\n13:30 – Lunch: rice, beef, veggies (700 kcal)\n20:00 – Dinner: pasta with chicken (600 kcal)",
          week:["Mon: chicken & rice","Tue: beef & potatoes","Wed: omelet & toasts","Thu: pasta & chicken","Fri: fish & rice","Sat: turkey & pasta","Sun: homemade pizza"]},
        keep: {title:"Maintain Weight", text:"07:30 – Breakfast: yogurt with muesli (350 kcal)\n13:00 – Lunch: chicken, buckwheat, veggies (550 kcal)\n19:30 – Dinner: fish + salad (450 kcal)",
          week:["Mon: porridge, fruits","Tue: fish & veggies","Wed: chicken & salad","Thu: omelet & veggies","Fri: yogurt & nuts","Sat: turkey & veggies","Sun: vegetable soup"]}
      }
    };

    const uiText = {
      ru:{title:"AI Diet Planner (online)",subtitle:"Загрузи фото — получи готовую диету",uploadTitle:"Загрузка фото",uploadBtn:"Выбрать фото",analyze:"Назначить диету",resultTitle:"Твоя диета",empty:"Здесь появится план питания",week:"Диета недели"},
      en:{title:"AI Diet Planner (online)",subtitle:"Upload a photo — get your diet plan",uploadTitle:"Upload Photo",uploadBtn:"Choose Photo",analyze:"Generate Diet",resultTitle:"Your Diet",empty:"Your diet plan will appear here",week:"Weekly Diet"},
      ka:{title:"AI დიეტის პლანერი",subtitle:"ატვირთე ფოტო — მიიღე დიეტა",uploadTitle:"ფოტოს ატვირთვა",uploadBtn:"ფოტო",analyze:"დიეტის გენერაცია",resultTitle:"შენი დიეტა",empty:"აქ გამოჩნდება დიეტა",week:"კვირის დიეტა"}
    };

    fileInput.addEventListener('change', e=>{
      const f = e.target.files[0];
      if(f){ img.src = URL.createObjectURL(f); img.hidden = false; }
    });

    function speak(text, lang) {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = lang==="ru"?"ru-RU":lang==="en"?"en-US":"ka-GE";
      speechSynthesis.cancel();
      speechSynthesis.speak(utterance);
    }

    // ==== Chart.js интеграция ====
    const history = [];
    const ctx = document.getElementById('chart').getContext('2d');
    const chart = new Chart(ctx, {
      type: 'line',
      data: { labels: [], datasets:[
        {label:'Калории', data:[], borderColor:'rgba(255,215,0,1)', backgroundColor:'rgba(255,215,0,0.2)', fill:true, tension:0.3},
        {label:'Вес (кг)', data:[], borderColor:'rgba(96,165,250,1)', backgroundColor:'rgba(96,165,250,0.2)', fill:true, tension:0.3}
      ]},
      options:{responsive:true, plugins:{legend:{labels:{color:'#FFD700', font:{size:14}}}}, scales:{x:{ticks:{color:'#FFD700'}},y:{ticks:{color:'#FFD700'}}}}
    });

    function updateChart(calories, weight){
      const date = new Date().toLocaleDateString('ru-RU',{weekday:'short'});
      history.push({date, cal:calories, weight});
      if(history.length>7) history.shift();
      chart.data.labels = history.map(h=>h.date);
      chart.data.datasets[0].data = history.map(h=>h.cal);
      chart.data.datasets[1].data = history.map(h=>h.weight);
      chart.update();
    }

    analyzeBtn.addEventListener('click', ()=>{
      const h = parseFloat(document.getElementById("height").value);
      const w = parseFloat(document.getElementById("weight").value);
      let dietType;
      if(h && w){
        const bmi = w/((h/100)**2);
        dietType = bmi<18.5?"gain":bmi>25?"loss":"keep";
      } else {
        const types=["loss","gain","keep"];
        dietType=types[Math.floor(Math.random()*3)];
      }
      const d = diets[currentLang][dietType];
      resultEl.innerHTML = `<h3>${d.title}</h3>${d.text.replace(/\n/g,"<br>")}`;
      weekEl.innerHTML = `<h3>${uiText[currentLang].week}</h3><ul>${d.week.map(x=>"<li>"+x+"</li>").join("")}</ul>`;
      speak(`${d.title}. ${d.text}`, currentLang);

      // обновление графика
      const caloriesToday = Math.floor(Math.random()*500 + 1800);
      const weightToday = w || 70;
      updateChart(caloriesToday, weightToday);
    });

    function setLanguage(lang){
      currentLang=lang;
      const t=uiText[lang];
      document.getElementById("title").innerText=t.title;
      document.getElementById("subtitle").innerText=t.subtitle;
      document.getElementById("uploadTitle").innerText=t.uploadTitle;
      document.getElementById("uploadBtn").innerText=t.uploadBtn;
      document.getElementById("analyze").innerText=t.analyze;
      document.getElementById("resultTitle").innerText=t.resultTitle;
      resultEl.innerText=t.empty;
      weekEl.innerHTML="";
      flags.forEach(f=>f.classList.toggle('active',f.dataset.lang===lang));
    }

    flags.forEach(flag=>flag.addEventListener('click',()=>setLanguage(flag.dataset.lang)));
    setLanguage('ru');
  </script>
</body>
</html>
