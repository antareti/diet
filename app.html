<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>AI Diet Planner</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {margin:0;font-family:system-ui;background:#0b0c10;color:#FFD700;display:flex;flex-direction:column;align-items:center;}
header {text-align:center;margin:20px;}
.container {max-width:1400px;width:100%;display:flex;gap:20px;margin:20px;justify-content:center;}
.side-img {flex:0 0 250px;display:flex;flex-direction:column;gap:20px;}
.side-img img {width:100%;border-radius:14px;border:1px solid rgba(255,255,255,.1);}
.app {flex:1;display:flex;gap:20px;flex-wrap:wrap;}
.card {background:#111319;border-radius:18px;padding:20px;box-shadow:0 6px 18px rgba(0,0,0,.35);flex:1 1 300px;}
.btn {display:inline-block;padding:12px 18px;border-radius:12px;background:linear-gradient(135deg,#6ee7b7,#60a5fa);color:#0b1220;font-weight:700;cursor:pointer;border:none;margin-top:10px;text-decoration:none;text-align:center;}
.btn:hover {opacity:0.9;transform:scale(1.05);transition:0.2s;}
input[type=file]{display:none}
.preview img {max-width:100%;border-radius:14px;border:1px solid rgba(255,255,255,.1);}
.diet {margin-top:12px;line-height:1.5;}
h2 {margin-top:0;}
#lang-switcher {display:flex;justify-content:center;gap:10px;margin-top:10px;}
.flag {cursor:pointer;width:40px;height:28px;border-radius:6px;border:2px solid transparent;transition:all 0.3s ease;}
.flag:hover {transform:scale(1.2);}
.flag.active {border-color:#60a5fa;background: rgba(96,165,250,0.2);}
.inputs {margin-top:15px;display:flex;gap:10px;flex-wrap:wrap;}
.inputs input {flex:1 1 120px;padding:10px;border-radius:10px;border:1px solid #333;background:#1a1c22;color:#FFD700;}
#week {margin-top:20px;padding-top:15px;border-top:1px solid #333;}
#week h3 {margin-top:0;}
canvas {background:#111319;border-radius:14px;margin-top:10px;}
@media(max-width:1200px){.container{flex-direction:column;align-items:center;}.side-img{flex-direction:row;width:100%;justify-content:space-between;}.side-img img{width:48%;}.app{width:100%;}}
</style>
</head>
<body>

<header>
<h1 id="title">AI Diet Planner (online)</h1>
<p id="subtitle">Загрузи фото — получи готовую диету</p>
<div id="lang-switcher">
<img class="flag active" data-lang="ru" src="https://flagcdn.com/w40/ru.png" alt="RU">
<img class="flag" data-lang="en" src="https://flagcdn.com/w40/gb.png" alt="EN">
<img class="flag" data-lang="ka" src="https://flagcdn.com/w40/ge.png" alt="GE">
</div>
<a href="diets.html" class="btn">Перейти к диетам</a>
</header>

<div class="container">
<div class="side-img"><img src="11.png" alt="11"></div>

<main class="app">
<section class="card">
<h2 id="uploadTitle">Загрузка фото</h2>
<label class="btn" for="file" id="uploadBtn">Выбрать фото</label>
<input type="file" id="file" accept="image/*">
<div class="preview" style="margin-top:16px"><img id="img" hidden></div>
<div class="inputs">
<input type="number" id="height" placeholder="Рост (см)">
<input type="number" id="weight" placeholder="Вес (кг)">
</div>
<button class="btn" id="analyze">Назначить диету</button>
</section>

<section class="card">
<h2 id="resultTitle">Твоя диета</h2>
<div id="result" class="diet">Здесь появится план питания</div>
<div id="week"></div>
<h2>График веса и калорий</h2>
<canvas id="chart" width="400" height="200"></canvas>
<div id="payNotice" style="margin-top:10px;color:#60a5fa;font-weight:bold;"></div>
</section>
</main>

<div class="side-img"><img src="10.png" alt="10"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
let isAdmin=false; // <-- true для админа
const ctx = document.getElementById('chart').getContext('2d');
const chart = new Chart(ctx,{
  type:'line',
  data:{labels:[],datasets:[
    {label:'Вес (кг)',data:[],borderColor:'#6ee7b7',fill:false},
    {label:'Калории',data:[],borderColor:'#60a5fa',fill:false}
  ]},
  options:{responsive:true,plugins:{legend:{labels:{color:'#FFD700'}}},scales:{x:{ticks:{color:'#FFD700'}},y:{ticks:{color:'#FFD700'}}}}
});

function updateChart(){
  if(!isAdmin){
    chart.data.labels=[];
    chart.data.datasets[0].data=[];
    chart.data.datasets[1].data=[];
    chart.update();
    document.getElementById('payNotice').innerText='График доступен после оплаты.';
  } else {
    // пример данных по дате
    const labels=['01.09','02.09','03.09','04.09','05.09','06.09'];
    const weight=[70,70.5,70.2,70,69.8,69.5];
    const calories=[2200,2100,2300,2000,2250,2100];
    chart.data.labels=labels;
    chart.data.datasets[0].data=weight;
    chart.data.datasets[1].data=calories;
    chart.update();
    document.getElementById('payNotice').innerText='';
  }
}

updateChart();

// --- Старый функционал ---
const fileInput=document.getElementById('file');
const img=document.getElementById('img');
const analyzeBtn=document.getElementById('analyze');
const resultEl=document.getElementById('result');
const weekEl=document.getElementById('week');
const flags=document.querySelectorAll('.flag');
let currentLang='ru';

fileInput.addEventListener('change',e=>{const f=e.target.files[0];if(f){img.src=URL.createObjectURL(f);img.hidden=false;}});
function speak(text,lang){const u=new SpeechSynthesisUtterance(text);u.lang=lang==='ru'?'ru-RU':lang==='en'?'en-US':'ka-GE';speechSynthesis.cancel();speechSynthesis.speak(u);}

const diets={
  ru:{loss:{title:"Похудение",text:"08:00 – Завтрак: овсянка с ягодами (300 ккал)\n13:00 – Обед: куриная грудка + салат (450 ккал)\n19:00 – Ужин: салат с тунцом (350 ккал)",week:["Пн: овощной суп","Вт: рыба на пару","Ср: куриная грудка","Чт: омлет","Пт: творог, фрукты","Сб: индейка","Вс: лёгкий суп"]},
      gain:{title:"Набор массы",text:"08:00 – Завтрак: омлет из 4 яиц, хлеб (500 ккал)\n13:30 – Обед: рис, говядина, овощи (700 ккал)\n20:00 – Ужин: паста с курицей (600 ккал)",week:["Пн: курица, рис","Вт: говядина, картофель","Ср: омлет, тосты","Чт: паста, курица","Пт: рыба, рис","Сб: индейка, макароны","Вс: пицца домашняя"]},
      keep:{title:"Поддержание веса",text:"07:30 – Завтрак: йогурт с мюсли (350 ккал)\n13:00 – Обед: курица, гречка, овощи (550 ккал)\n19:30 – Ужин: рыба + салат (450 ккал)",week:["Пн: каша, фрукты","Вт: рыба, овощи","Ср: курица, салат","Чт: омлет, овощи","Пт: йогурт, орехи","Сб: индейка, овощи","Вс: овощной суп"]}},
  en:{loss:{title:"Weight Loss",text:"08:00 – Breakfast: oatmeal with berries (300 kcal)\n13:00 – Lunch: grilled chicken + salad (450 kcal)\n19:00 – Dinner: tuna salad (350 kcal)",week:["Mon: veg soup","Tue: steamed fish","Wed: chicken","Thu: omelet","Fri: cottage cheese","Sat: turkey","Sun: light soup"]},
      gain:{title:"Muscle Gain",text:"08:00 – Breakfast: 4-egg omelet, bread (500 kcal)\n13:30 – Lunch: rice, beef, veggies (700 kcal)\n20:00 – Dinner: pasta with chicken (600 kcal)",week:["Mon: chicken & rice","Tue: beef & potatoes","Wed: omelet & toasts","Thu: pasta & chicken","Fri: fish & rice","Sat: turkey & pasta","Sun: homemade pizza"]},
      keep:{title:"Maintain Weight",text:"07:30 – Breakfast: yogurt with muesli (350 kcal)\n13:00 – Lunch: chicken, buckwheat, veggies (550 kcal)\n19:30 – Dinner: fish + salad (450 kcal)",week:["Mon: porridge","Tue: fish & veggies","Wed: chicken & salad","Thu: omelet & veggies","Fri: yogurt & nuts","Sat: turkey & veggies","Sun: veg soup"]}}
};

const uiText={
  ru:{title:"AI Diet Planner (online)",subtitle:"Загрузи фото — получи готовую диету",uploadTitle:"Загрузка фото",uploadBtn:"Выбрать фото",analyze:"Назначить диету",resultTitle:"Твоя диета",empty:"Здесь появится план питания",week:"Диета недели"},
  en:{title:"AI Diet Planner (online)",subtitle:"Upload a photo — get your diet plan",uploadTitle:"Upload Photo",uploadBtn:"Choose Photo",analyze:"Generate Diet",resultTitle:"Your Diet",empty:"Your diet plan will appear here",week:"Weekly Diet"},
  ka:{title:"AI დიეტის პლანერი",subtitle:"ატვირთე ფოტო — მიიღე დიეტა",uploadTitle:"ფოტოს ატვირთვა",uploadBtn:"ფოტო",analyze:"დიეტის გენერაცია",resultTitle:"შენი დიეტა",empty:"აქ გამოჩნდება დიეტა",week:"კვირის დიეტა"}
};

analyzeBtn.addEventListener('click',()=>{
  const h=parseFloat(document.getElementById("height").value);
  const w=parseFloat(document.getElementById("weight").value);
  let dietType;
  if(h && w){const bmi=w/((h/100)**2);dietType=bmi<18.5?"gain":bmi>25?"loss":"keep";}else{dietType=["loss","gain","keep"][Math.floor(Math.random()*3)];}
  const d=diets[currentLang][dietType];
  resultEl.innerHTML=`<h3>${d.title}</h3>${d.text.replace(/\n/g,"<br>")}`;
  weekEl.innerHTML=`<h3>${uiText[currentLang].week}</h3><ul>${d.week.map(x=>"<li>"+x+"</li>").join("")}</ul>`;
  speak(`${d.title}. ${d.text}`,currentLang);
});

function setLanguage(lang){currentLang=lang;const t=uiText[lang];document.getElementById("title").innerText=t.title;document.getElementById("subtitle").innerText=t.subtitle;document.getElementById("uploadTitle").innerText=t.uploadTitle;document.getElementById("uploadBtn").innerText=t.uploadBtn;document.getElementById("analyze").innerText=t.analyze;document.getElementById("resultTitle").innerText=t.resultTitle;resultEl.innerText=t.empty;weekEl.innerHTML="";flags.forEach(f=>f.classList.toggle('active',f.dataset.lang===lang));}
flags.forEach(flag=>flag.addEventListener('click',()=>setLanguage(flag.dataset.lang)));setLanguage('ru');
</script>
</body>
</html>
